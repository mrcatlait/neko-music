<div class="genre-autocomplete">
  <!-- Selected Genres as Chips -->
  @if (selectedGenres().length > 0) {
    <div class="genre-autocomplete__selected">
      @for (genre of selectedGenres(); track genre.id) {
        <n-input-chip (remove)="removeGenre(genre)">
          {{ genre.name }}
        </n-input-chip>
      }
    </div>
  }

  <!-- Search Input -->
  <div class="genre-autocomplete__search">
    <n-textfield>
      <label for="genre-search">Search Genres</label>

      <input
        #searchInput
        autocomplete="off"
        id="genre-search"
        type="text"
        [disabled]="disabled()"
        [formControl]="searchControl"
        [placeholder]="placeholder()"
        (focus)="showDropdownOnFocus()"
      />
    </n-textfield>

    <!-- Dropdown -->
    @if (showDropdown() && filteredGenres().length > 0) {
      <div class="genre-autocomplete__dropdown">
        @for (genre of filteredGenres(); track genre.id) {
          <button
            class="genre-autocomplete__option"
            type="button"
            (click)="selectGenre(genre)"
          >
            {{ genre.name }}
          </button>
        }
      </div>
    }

    <!-- No Results Message -->
    @if (showDropdown() && filteredGenres().length === 0 && searchControl.value) {
      <div class="genre-autocomplete__dropdown">
        <div class="genre-autocomplete__no-results">No genres found for "{{ searchControl.value }}"</div>
      </div>
    }
  </div>
</div>
